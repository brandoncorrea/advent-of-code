(ns aoc.2021.day02-spec
  (:require [speclj.core :refer :all]
            [aoc.2021.day02 :refer :all]))

; https://adventofcode.com/2021/day/2

(def moves
  [:forward 2
   :down 4
   :down 3
   :up 4
   :down 1
   :down 8
   :up 9
   :forward 1
   :down 9
   :forward 6
   :down 7
   :forward 1
   :down 1
   :up 2
   :forward 8
   :down 3
   :down 9
   :down 3
   :down 8
   :forward 3
   :forward 5
   :up 8
   :forward 6
   :forward 5
   :forward 6
   :forward 4
   :up 3
   :forward 1
   :up 4
   :forward 2
   :up 2
   :up 2
   :down 6
   :forward 3
   :forward 4
   :forward 5
   :forward 1
   :down 1
   :down 1
   :forward 3
   :forward 2
   :up 7
   :forward 6
   :down 5
   :forward 9
   :up 4
   :down 6
   :up 8
   :forward 7
   :forward 5
   :forward 8
   :down 5
   :down 9
   :forward 3
   :forward 2
   :forward 9
   :forward 1
   :down 3
   :forward 1
   :down 9
   :forward 4
   :forward 3
   :forward 7
   :forward 6
   :forward 6
   :forward 6
   :forward 8
   :forward 5
   :forward 4
   :up 1
   :forward 8
   :forward 1
   :down 7
   :forward 2
   :up 9
   :forward 4
   :up 7
   :down 4
   :down 3
   :down 9
   :down 7
   :down 1
   :forward 2
   :up 6
   :down 2
   :down 3
   :down 5
   :forward 6
   :forward 5
   :forward 6
   :forward 2
   :forward 1
   :forward 5
   :forward 5
   :down 9
   :forward 8
   :forward 3
   :down 8
   :up 2
   :forward 5
   :forward 6
   :down 1
   :down 7
   :down 5
   :forward 3
   :down 9
   :down 2
   :forward 6
   :forward 6
   :forward 4
   :up 5
   :up 2
   :up 2
   :up 2
   :forward 2
   :up 3
   :down 4
   :forward 2
   :down 6
   :forward 1
   :down 8
   :up 6
   :up 9
   :forward 7
   :forward 5
   :forward 9
   :forward 5
   :up 3
   :up 6
   :up 3
   :forward 9
   :forward 7
   :up 7
   :forward 3
   :forward 3
   :down 5
   :down 2
   :down 1
   :down 8
   :up 7
   :down 2
   :up 4
   :forward 5
   :down 5
   :down 8
   :down 4
   :down 8
   :down 4
   :down 8
   :down 2
   :forward 5
   :down 9
   :forward 6
   :forward 5
   :up 4
   :up 2
   :down 7
   :down 9
   :forward 6
   :forward 6
   :down 3
   :up 9
   :up 8
   :down 4
   :forward 9
   :down 7
   :down 4
   :down 6
   :down 4
   :down 7
   :down 2
   :up 9
   :forward 9
   :forward 6
   :down 6
   :up 6
   :down 7
   :down 5
   :forward 9
   :down 9
   :down 8
   :down 6
   :down 3
   :forward 5
   :down 5
   :forward 2
   :up 4
   :down 5
   :forward 6
   :forward 6
   :forward 6
   :down 4
   :down 8
   :down 3
   :down 5
   :forward 6
   :forward 2
   :forward 4
   :forward 2
   :forward 3
   :up 9
   :forward 8
   :down 5
   :down 9
   :forward 5
   :forward 7
   :down 5
   :down 2
   :up 3
   :forward 4
   :forward 4
   :up 4
   :forward 5
   :forward 8
   :up 4
   :forward 3
   :down 8
   :up 8
   :forward 9
   :up 9
   :forward 5
   :forward 8
   :down 8
   :up 9
   :up 2
   :forward 3
   :forward 7
   :down 9
   :down 6
   :forward 5
   :down 1
   :forward 6
   :forward 8
   :up 2
   :down 8
   :forward 2
   :forward 7
   :down 7
   :down 7
   :down 7
   :down 3
   :up 6
   :down 5
   :down 4
   :forward 1
   :forward 3
   :down 3
   :down 1
   :forward 7
   :forward 8
   :up 8
   :forward 3
   :forward 8
   :up 9
   :down 5
   :down 9
   :forward 4
   :down 9
   :up 8
   :up 1
   :forward 6
   :down 2
   :up 2
   :down 3
   :up 1
   :down 7
   :down 8
   :forward 6
   :forward 8
   :up 5
   :up 2
   :down 1
   :forward 6
   :down 1
   :up 6
   :down 9
   :down 8
   :down 5
   :down 7
   :forward 8
   :down 1
   :up 5
   :down 2
   :down 5
   :forward 9
   :up 8
   :down 6
   :forward 7
   :forward 8
   :down 5
   :forward 3
   :forward 4
   :up 1
   :forward 2
   :forward 9
   :up 7
   :down 9
   :forward 2
   :down 3
   :down 6
   :down 9
   :forward 4
   :up 3
   :forward 3
   :down 6
   :forward 1
   :down 3
   :down 4
   :down 8
   :down 5
   :forward 6
   :down 7
   :forward 6
   :up 8
   :forward 9
   :down 3
   :forward 8
   :forward 9
   :down 3
   :forward 9
   :forward 4
   :forward 2
   :down 4
   :down 1
   :forward 3
   :forward 3
   :forward 3
   :down 1
   :down 6
   :up 1
   :down 6
   :forward 2
   :down 6
   :down 4
   :down 4
   :forward 5
   :down 4
   :up 4
   :up 7
   :down 4
   :forward 4
   :down 8
   :down 5
   :down 2
   :down 3
   :forward 3
   :down 4
   :forward 8
   :down 4
   :down 2
   :up 2
   :down 8
   :forward 9
   :down 1
   :up 1
   :down 8
   :down 8
   :up 2
   :down 8
   :up 2
   :forward 4
   :down 2
   :forward 8
   :down 1
   :down 9
   :forward 3
   :up 5
   :down 8
   :down 2
   :forward 5
   :forward 1
   :forward 6
   :forward 1
   :down 8
   :forward 3
   :down 5
   :up 7
   :down 8
   :forward 5
   :down 8
   :forward 2
   :down 6
   :down 9
   :forward 9
   :down 8
   :forward 7
   :forward 1
   :forward 9
   :forward 8
   :forward 2
   :down 4
   :forward 8
   :up 7
   :down 2
   :down 6
   :forward 5
   :forward 4
   :down 5
   :down 2
   :forward 2
   :up 8
   :up 4
   :down 8
   :forward 2
   :up 3
   :forward 3
   :down 4
   :forward 8
   :forward 7
   :forward 4
   :up 1
   :down 6
   :forward 1
   :down 3
   :forward 6
   :up 3
   :forward 7
   :down 6
   :forward 7
   :forward 5
   :forward 8
   :down 9
   :up 7
   :down 1
   :down 5
   :forward 1
   :down 8
   :down 1
   :forward 4
   :forward 5
   :forward 5
   :down 9
   :forward 9
   :down 4
   :forward 1
   :up 8
   :down 5
   :down 9
   :down 3
   :down 2
   :down 5
   :down 3
   :forward 7
   :up 3
   :forward 3
   :down 4
   :up 5
   :forward 4
   :up 6
   :down 4
   :forward 2
   :up 3
   :down 2
   :up 1
   :up 7
   :down 5
   :up 3
   :forward 5
   :up 2
   :down 9
   :down 6
   :forward 5
   :up 3
   :down 7
   :up 1
   :forward 1
   :forward 3
   :down 9
   :down 1
   :forward 6
   :down 5
   :forward 8
   :down 1
   :down 5
   :up 6
   :forward 8
   :forward 8
   :forward 9
   :down 1
   :down 6
   :down 8
   :up 1
   :down 7
   :forward 3
   :forward 5
   :forward 2
   :down 4
   :forward 4
   :forward 2
   :down 8
   :up 2
   :down 1
   :up 9
   :down 4
   :up 9
   :down 2
   :forward 5
   :forward 4
   :forward 7
   :down 8
   :forward 4
   :down 5
   :forward 7
   :forward 2
   :down 6
   :down 3
   :forward 7
   :forward 8
   :forward 2
   :down 3
   :forward 4
   :down 6
   :forward 4
   :forward 3
   :down 3
   :forward 3
   :down 8
   :down 2
   :forward 6
   :down 4
   :down 9
   :down 2
   :down 7
   :forward 4
   :forward 1
   :forward 7
   :down 9
   :down 5
   :forward 5
   :up 7
   :forward 4
   :down 1
   :up 3
   :down 5
   :down 3
   :down 7
   :down 7
   :down 7
   :up 6
   :forward 3
   :down 6
   :down 3
   :up 2
   :down 7
   :forward 5
   :forward 5
   :down 6
   :forward 9
   :up 2
   :forward 6
   :forward 3
   :forward 5
   :forward 9
   :forward 1
   :up 4
   :up 7
   :down 8
   :down 3
   :forward 1
   :down 6
   :up 8
   :down 7
   :down 8
   :down 9
   :down 9
   :forward 5
   :down 6
   :up 7
   :down 3
   :down 5
   :down 5
   :down 6
   :up 3
   :forward 8
   :down 4
   :up 8
   :forward 4
   :down 1
   :up 8
   :up 5
   :down 4
   :up 8
   :forward 8
   :forward 7
   :up 3
   :down 7
   :forward 8
   :down 1
   :down 7
   :down 5
   :down 5
   :down 2
   :up 3
   :forward 3
   :forward 8
   :down 4
   :down 3
   :up 7
   :down 1
   :down 9
   :forward 9
   :forward 1
   :forward 1
   :forward 2
   :down 7
   :down 9
   :up 5
   :down 1
   :forward 4
   :forward 9
   :forward 3
   :forward 3
   :forward 4
   :forward 1
   :down 2
   :down 2
   :up 1
   :forward 7
   :forward 8
   :forward 6
   :up 6
   :down 5
   :forward 2
   :down 4
   :forward 5
   :forward 2
   :forward 7
   :down 1
   :down 9
   :forward 2
   :forward 2
   :forward 3
   :up 2
   :up 2
   :up 2
   :down 5
   :forward 5
   :forward 9
   :down 4
   :down 2
   :down 5
   :down 9
   :up 7
   :forward 2
   :forward 7
   :forward 4
   :forward 5
   :down 5
   :down 8
   :down 9
   :down 4
   :up 8
   :up 1
   :forward 8
   :up 2
   :up 8
   :up 4
   :forward 1
   :forward 4
   :down 9
   :up 1
   :down 8
   :down 4
   :down 4
   :down 2
   :down 9
   :forward 7
   :up 1
   :down 4
   :forward 4
   :down 8
   :forward 1
   :forward 8
   :forward 1
   :up 7
   :forward 4
   :forward 6
   :forward 2
   :forward 8
   :up 4
   :down 1
   :up 7
   :up 8
   :down 9
   :forward 3
   :down 3
   :forward 6
   :forward 5
   :up 1
   :forward 9
   :up 6
   :up 1
   :forward 1
   :forward 2
   :forward 7
   :down 8
   :up 4
   :forward 4
   :down 3
   :down 3
   :forward 2
   :forward 6
   :down 4
   :forward 2
   :forward 8
   :up 5
   :down 1
   :forward 7
   :up 6
   :forward 2
   :down 6
   :forward 7
   :down 2
   :down 9
   :down 1
   :up 4
   :up 8
   :down 7
   :up 6
   :forward 3
   :forward 4
   :down 6
   :forward 5
   :down 3
   :up 6
   :down 3
   :down 7
   :forward 7
   :up 3
   :down 1
   :forward 2
   :up 2
   :up 6
   :up 1
   :up 8
   :up 3
   :down 9
   :down 8
   :forward 6
   :up 9
   :down 1
   :forward 5
   :down 4
   :up 7
   :down 5
   :up 1
   :down 9
   :down 8
   :down 2
   :down 1
   :up 8
   :up 7
   :up 5
   :down 5
   :forward 1
   :forward 6
   :down 4
   :down 3
   :forward 5
   :forward 5
   :up 5
   :down 6
   :down 6
   :down 2
   :down 7
   :up 1
   :up 9
   :up 4
   :down 7
   :up 5
   :forward 5
   :forward 6
   :forward 6
   :down 7
   :down 6
   :up 8
   :forward 8
   :forward 1
   :down 6
   :up 2
   :forward 8
   :down 7
   :down 5
   :up 1
   :up 7
   :up 2
   :up 3
   :down 3
   :forward 1
   :forward 4
   :up 8
   :forward 9
   :down 1
   :up 4
   :forward 3
   :down 9
   :down 9
   :forward 4
   :down 8
   :up 2
   :forward 1
   :forward 3
   :up 5
   :forward 5
   :up 4
   :forward 5
   :forward 6
   :forward 2
   :forward 4
   :up 5
   :down 7
   :up 1
   :forward 7
   :down 5
   :forward 5
   :down 5
   :up 2
   :down 3
   :forward 6
   :forward 5
   :up 4
   :up 5
   :down 2
   :forward 2
   :down 2
   :down 2
   :up 8
   :up 2
   :down 7
   :forward 3
   :down 7
   :down 7
   :down 2
   :up 5
   :up 5
   :forward 5
   :up 5
   :down 9
   :down 1
   :up 7
   :up 5
   :forward 5
   :forward 1
   :down 7
   :down 8
   :down 4
   :forward 1
   :down 2
   :up 9
   :forward 1
   :forward 5
   :forward 8
   :down 7
   :down 6
   :up 2
   :down 6
   :forward 4
   :down 9
   :down 1
   :down 9
   :up 5
   :up 1
   :down 9
   :forward 7
   :up 4
   :down 5
   :up 1
   :forward 2
   :forward 2
   :up 9
   :forward 8
   :up 4
   :up 1
   :up 6
   :up 5
   :down 5
   :up 4
   :up 1
   :forward 9
   :forward 3
   :down 4
   :down 9
   :down 4
   :forward 9
   :down 2
   :down 1
   :up 9
   :up 4
   :forward 8
   :forward 9
   :forward 8
   :up 4
   :forward 6
   :down 7
   :down 6
   :down 1
   :forward 5
   :forward 4
   :up 4
   :forward 4
   :up 2
   :forward 7
   :forward 2
   :down 2
   :down 1
   :up 5
   :up 7
   :down 5
   :down 9
   :up 1
   :down 2
   :forward 4
   :forward 8
   :up 1
   :forward 7
   :down 7
   :forward 1
   :down 2
   :down 9
   :forward 7
   :forward 6
   :forward 1
   :forward 6
   :forward 9
   :up 8
   :forward 4
   :up 6
   :forward 9
   :forward 1
   :forward 7
   :forward 9
   :down 9
   :down 7
   :down 6
   :down 2
   :down 4
   :forward 9
   :forward 4
   :forward 6
   :forward 1
   :forward 3
   :down 2
   :forward 9
   :down 9
   :forward 8
   :forward 7
   :up 4
   :forward 7
   :forward 8
   :up 4
   :down 1
   :up 3
   :down 1
   :down 9
   :down 5
   :down 2
   :down 8
   :down 3
   :down 8
   :forward 2
   :forward 5
   :down 5
   :down 7
   :forward 4
   :up 6
   :forward 5
   :up 2
   :up 6
   :forward 6
   :down 7
   :down 8
   :up 4
   :up 9
   :forward 7
   :down 3
   :forward 8
   :forward 6
   :up 3
   :up 4
   :down 1
   :forward 2
   :down 9
   :down 1
   :down 6
   :down 5
   :up 7
   :forward 7
   :down 6
   :down 2
   :down 5
   :up 2
   :forward 7
   :forward 2
   :down 6
   :down 1
   :forward 4
   :up 9
   :down 1
   :down 7
   :forward 1])

(def example
  [:forward 5
   :down 5
   :forward 8
   :up 3
   :down 8
   :forward 2])

(describe "AoC Day 2 Part 1"
  (it "No moves results in 0"
    (should= 0 (day-2-p1 [])))
  (it "Only forward moves results in 0"
    (should= 0 (day-2-p1 [:forward 1 :forward 2 :forward 10000])))
  (it "Only up or down moves results in 0"
    (should= 0 (day-2-p1 [:up 1 :up 6 :down 2 :down 1 :up 3 :down 2 :up 50])))
  (it "Down and forward result in their product"
    (should= 10 (day-2-p1 [:down 2 :forward 5])))
  (it "Down 2 and Forward 2 results in the product of the sums of each"
    (should= 40 (day-2-p1 [:down 1 :down 3 :forward 4 :forward 6])))
  (it "Ups are taken as negatives"
    (should= 21 (day-2-p1 [:down 4 :up 3 :down 20 :forward 1])))
  (it "Solves AoC Example"
    (should= 150 (day-2-p1 example)))
  (it "Solves AoC Test Data"
    (should= 1938402 (day-2-p1 moves))))

(describe "AoC Day 2 Part 2"
  (it "No moves results in 0"
    (should= 0 (day-2-p2 [])))
  (it "Only forward moves results in 0"
    (should= 0 (day-2-p2 [:forward 1 :forward 2 :forward 10000])))
  (it "Only up or down moves results in 0"
    (should= 0 (day-2-p2 [:up 1 :up 6 :down 2 :down 1 :up 3 :down 2 :up 50])))
  (it "Down and Forward results in down times forward squared"
    (should= 108 (day-2-p2 [:down 3 :forward 6])))
  (it "Solves AoC Example"
    (should= 900 (day-2-p2 example)))
  (it "Solves AoC Test Data"
    (should= 1947878632 (day-2-p2 moves))))
